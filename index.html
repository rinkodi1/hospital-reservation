<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>病院予約システム</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
</head>
<body>
    <!-- メイン画面 -->
    <div id="main-screen" class="screen active">
        <div class="container">
            <header class="header">
                <h1><i class="fas fa-hospital"></i> サンプル病院 予約システム</h1>
                <button id="admin-login-btn" class="btn btn--outline admin-btn">
                    <i class="fas fa-cog"></i> 管理者ログイン
                </button>
            </header>
            
            <div class="hospital-message">
                <div class="message-box">
                    <h3><i class="fas fa-info-circle"></i> お知らせ</h3>
                    <p id="hospital-message-text">本日も皆様のご健康をサポートいたします。ご予約をお取りいただき、ありがとうございます。</p>
                </div>
            </div>
            
            <div class="main-actions">
                <button id="start-reservation-btn" class="btn btn--primary btn--lg">
                    <i class="fas fa-calendar-plus"></i> 予約を開始する
                </button>
            </div>
        </div>
    </div>

    <!-- 予約プロセス画面 -->
    <div id="reservation-screen" class="screen">
        <div class="container">
            <div class="reservation-header">
                <button id="back-to-main" class="btn btn--outline">
                    <i class="fas fa-arrow-left"></i> メイン画面に戻る
                </button>
                <h2>予約申込</h2>
            </div>
            
            <!-- ステップインジケーター -->
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">個人情報</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">予約種類</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">希望日</div>
                </div>
                <div class="step" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-label">時間選択</div>
                </div>
                <div class="step" data-step="5">
                    <div class="step-number">5</div>
                    <div class="step-label">備考</div>
                </div>
                <div class="step" data-step="6">
                    <div class="step-number">6</div>
                    <div class="step-label">確認</div>
                </div>
            </div>

            <!-- ステップ1: 個人情報 -->
            <div id="step-1" class="step-content active">
                <div class="card">
                    <div class="card__header">
                        <h3>個人情報の入力</h3>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="patient-name">お名前 <span class="required">*</span></label>
                            <input type="text" id="patient-name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="patient-email">メールアドレス <span class="required">*</span></label>
                            <input type="email" id="patient-email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="patient-phone">電話番号 <span class="required">*</span></label>
                            <input type="tel" id="patient-phone" class="form-control" required>
                        </div>
                        <button id="next-to-step-2" class="btn btn--primary">次へ進む</button>
                    </div>
                </div>
            </div>

            <!-- ステップ2: 予約種類選択 -->
            <div id="step-2" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h3>予約種類の選択</h3>
                    </div>
                    <div class="card__body">
                        <div id="reservation-types-list">
                            <!-- 動的に生成 -->
                        </div>
                        <div class="step-actions">
                            <button id="back-to-step-1" class="btn btn--outline">戻る</button>
                            <button id="next-to-step-3" class="btn btn--primary" disabled>次へ進む</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ステップ3: 希望日選択 -->
            <div id="step-3" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h3>希望日の選択</h3>
                    </div>
                    <div class="card__body">
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <button id="prev-month" class="btn btn--outline btn--sm">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <h4 id="current-month-year"></h4>
                                <button id="next-month" class="btn btn--outline btn--sm">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            <div id="calendar-grid" class="calendar-grid">
                                <!-- カレンダーが動的に生成される -->
                            </div>
                        </div>
                        <div class="step-actions">
                            <button id="back-to-step-2" class="btn btn--outline">戻る</button>
                            <button id="next-to-step-4" class="btn btn--primary" disabled>次へ進む</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ステップ4: 時間選択 -->
            <div id="step-4" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h3>時間枠の選択</h3>
                        <p class="selected-date-info">選択日: <span id="selected-date-display"></span></p>
                    </div>
                    <div class="card__body">
                        <div id="time-slots-container">
                            <!-- 時間枠が動的に生成される -->
                        </div>
                        <div class="step-actions">
                            <button id="back-to-step-3" class="btn btn--outline">戻る</button>
                            <button id="next-to-step-5" class="btn btn--primary" disabled>次へ進む</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ステップ5: 備考入力 -->
            <div id="step-5" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h3>備考・メッセージ</h3>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="patient-notes">備考・ご要望等</label>
                            <textarea id="patient-notes" class="form-control" rows="4" placeholder="何かご要望やお伝えしたいことがございましたらご記入ください"></textarea>
                        </div>
                        <div class="step-actions">
                            <button id="back-to-step-4" class="btn btn--outline">戻る</button>
                            <button id="next-to-step-6" class="btn btn--primary">確認画面へ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ステップ6: 確認・完了 -->
            <div id="step-6" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h3>予約内容の確認</h3>
                    </div>
                    <div class="card__body">
                        <div id="reservation-summary">
                            <!-- 予約内容サマリーが動的に生成される -->
                        </div>
                        <div class="confirmation-notice">
                            <p><i class="fas fa-info-circle"></i> 予約完了後、登録されたメールアドレスに確認メールをお送りします。</p>
                        </div>
                        <div class="step-actions">
                            <button id="back-to-step-5" class="btn btn--outline">戻る</button>
                            <button id="confirm-reservation" class="btn btn--primary btn--lg">
                                <i class="fas fa-check-circle"></i> 予約を確定する
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 管理者ログイン画面 -->
    <div id="admin-login-screen" class="screen">
        <div class="container">
            <div class="login-container">
                <div class="card">
                    <div class="card__header">
                        <h3><i class="fas fa-lock"></i> 管理者ログイン</h3>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="admin-password">パスワード</label>
                            <input type="password" id="admin-password" class="form-control">
                        </div>
                        <div class="login-actions">
                            <button id="cancel-login" class="btn btn--outline">キャンセル</button>
                            <button id="admin-login-submit" class="btn btn--primary">ログイン</button>
                        </div>
                        <div id="login-error" class="error-message" style="display: none;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 管理者画面 -->
    <div id="admin-screen" class="screen">
        <div class="container">
            <header class="admin-header">
                <h2><i class="fas fa-cogs"></i> 管理者画面</h2>
                <button id="admin-logout" class="btn btn--outline">
                    <i class="fas fa-sign-out-alt"></i> ログアウト
                </button>
            </header>
            
            <nav class="admin-nav">
                <button class="nav-tab active" data-tab="reservations">
                    <i class="fas fa-calendar-check"></i> 予約管理
                </button>
                <button class="nav-tab" data-tab="types">
                    <i class="fas fa-list"></i> 予約種類管理
                </button>
                <button class="nav-tab" data-tab="settings">
                    <i class="fas fa-cog"></i> 設定
                </button>
            </nav>

            <!-- 予約管理タブ -->
            <div id="admin-reservations" class="admin-content active">
                <div class="admin-section">
                    <div class="section-header">
                        <h3>予約一覧</h3>
                        <div class="filter-controls">
                            <select id="filter-type" class="form-control">
                                <option value="">全ての種類</option>
                            </select>
                            <input type="date" id="filter-date" class="form-control">
                        </div>
                    </div>
                    <div id="reservations-list" class="reservations-table">
                        <!-- 予約一覧テーブルが動的に生成される -->
                    </div>
                </div>
            </div>

            <!-- 予約種類管理タブ -->
            <div id="admin-types" class="admin-content">
                <div class="admin-section">
                    <div class="section-header">
                        <h3>予約種類管理</h3>
                        <button id="add-new-type" class="btn btn--primary">
                            <i class="fas fa-plus"></i> 新しい種類を追加
                        </button>
                    </div>
                    <div id="types-list">
                        <!-- 予約種類一覧が動的に生成される -->
                    </div>
                </div>
            </div>

            <!-- 設定タブ -->
            <div id="admin-settings" class="admin-content">
                <div class="admin-section">
                    <h3>基本設定</h3>
                    
                    <div class="card">
                        <div class="card__header">
                            <h4>パスワード変更</h4>
                        </div>
                        <div class="card__body">
                            <div class="form-group">
                                <label class="form-label" for="new-admin-password">新しいパスワード</label>
                                <input type="password" id="new-admin-password" class="form-control">
                            </div>
                            <button id="change-password" class="btn btn--primary">パスワードを変更</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__header">
                            <h4>病院メッセージ</h4>
                        </div>
                        <div class="card__body">
                            <div class="form-group">
                                <label class="form-label" for="hospital-message-input">メイン画面に表示するメッセージ</label>
                                <textarea id="hospital-message-input" class="form-control" rows="3"></textarea>
                            </div>
                            <button id="update-hospital-message" class="btn btn--primary">メッセージを更新</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__header">
                            <h4>予約完了メールテンプレート</h4>
                        </div>
                        <div class="card__body">
                            <div class="form-group">
                                <label class="form-label" for="email-subject">件名</label>
                                <input type="text" id="email-subject" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="email-body">本文</label>
                                <textarea id="email-body" class="form-control" rows="10"></textarea>
                                <small class="form-text">使用可能な変数: {{hospitalName}}, {{patientName}}, {{reservationType}}, {{reservationDate}}, {{reservationTime}}</small>
                            </div>
                            <button id="update-email-template" class="btn btn--primary">テンプレートを更新</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__header">
                            <h4>EmailJS設定</h4>
                        </div>
                        <div class="card__body">
                            <div class="form-group">
                                <label class="form-label" for="emailjs-service-id">Service ID</label>
                                <input type="text" id="emailjs-service-id" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="emailjs-template-id">Template ID</label>
                                <input type="text" id="emailjs-template-id" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="emailjs-public-key">Public Key</label>
                                <input type="text" id="emailjs-public-key" class="form-control">
                            </div>
                            <button id="save-emailjs-config" class="btn btn--primary">設定を保存</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- モーダル類 -->
    <!-- 予約種類編集モーダル -->
    <div id="type-edit-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="type-modal-title">予約種類の編集</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="type-name">種類名</label>
                    <input type="text" id="type-name" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="type-interval">時間間隔（分）</label>
                    <input type="number" id="type-interval" class="form-control" min="5" step="5">
                </div>
                <div class="form-group">
                    <label class="form-label" for="type-capacity">定員</label>
                    <input type="number" id="type-capacity" class="form-control" min="1">
                </div>
                <div class="form-group">
                    <label class="form-label" for="type-start-time">開始時間</label>
                    <input type="time" id="type-start-time" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="type-end-time">終了時間</label>
                    <input type="time" id="type-end-time" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="type-available-from">予約可能開始日</label>
                    <input type="date" id="type-available-from" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="type-available-to">予約可能終了日</label>
                    <input type="date" id="type-available-to" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label">休業日設定</label>
                    <div class="weekday-checkboxes">
                        <label><input type="checkbox" value="0"> 日曜日</label>
                        <label><input type="checkbox" value="1"> 月曜日</label>
                        <label><input type="checkbox" value="2"> 火曜日</label>
                        <label><input type="checkbox" value="3"> 水曜日</label>
                        <label><input type="checkbox" value="4"> 木曜日</label>
                        <label><input type="checkbox" value="5"> 金曜日</label>
                        <label><input type="checkbox" value="6"> 土曜日</label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancel-type-edit" class="btn btn--outline">キャンセル</button>
                <button id="save-type-edit" class="btn btn--primary">保存</button>
            </div>
        </div>
    </div>

    <!-- 予約編集モーダル -->
    <div id="reservation-edit-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>予約の編集</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="edit-patient-name">患者名</label>
                    <input type="text" id="edit-patient-name" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="edit-patient-email">メールアドレス</label>
                    <input type="email" id="edit-patient-email" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="edit-patient-phone">電話番号</label>
                    <input type="tel" id="edit-patient-phone" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="edit-reservation-date">予約日</label>
                    <input type="date" id="edit-reservation-date" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="edit-reservation-time">予約時間</label>
                    <input type="time" id="edit-reservation-time" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label" for="edit-patient-notes">備考</label>
                    <textarea id="edit-patient-notes" class="form-control" rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button id="delete-reservation" class="btn btn--outline" style="color: var(--color-error);">削除</button>
                <button id="cancel-reservation-edit" class="btn btn--outline">キャンセル</button>
                <button id="save-reservation-edit" class="btn btn--primary">保存</button>
            </div>
        </div>
    </div>

    <!-- 成功・完了メッセージ -->
    <div id="success-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle" style="color: var(--color-success);"></i> 予約完了</h3>
            </div>
            <div class="modal-body">
                <p>予約が正常に完了いたしました。</p>
                <p>登録されたメールアドレスに確認メールをお送りしています。</p>
                <p>ご不明な点がございましたら、お電話にてお問い合わせください。</p>
            </div>
            <div class="modal-footer">
                <button id="close-success-modal" class="btn btn--primary">閉じる</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
