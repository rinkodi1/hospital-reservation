<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>さくら病院 予約システム</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 患者向け予約システム -->
    <div id="patient-system" class="patient-system">
        <div class="container">
            <header class="header">
                <h1>さくら病院 予約システム</h1>
                <p class="subtitle">オンライン予約をご利用ください</p>
            </header>

            <!-- ステップインジケーター -->
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <span class="step-number">1</span>
                    <span class="step-label">個人情報</span>
                </div>
                <div class="step" data-step="2">
                    <span class="step-number">2</span>
                    <span class="step-label">予約種類</span>
                </div>
                <div class="step" data-step="3">
                    <span class="step-number">3</span>
                    <span class="step-label">日時選択</span>
                </div>
                <div class="step" data-step="4">
                    <span class="step-number">4</span>
                    <span class="step-label">確認</span>
                </div>
                <div class="step" data-step="5">
                    <span class="step-number">5</span>
                    <span class="step-label">完了</span>
                </div>
            </div>

            <!-- ステップ1: 個人情報入力 -->
            <div id="step-1" class="step-content active">
                <div class="card">
                    <div class="card__header">
                        <h2>個人情報入力</h2>
                    </div>
                    <div class="card__body">
                        <form id="patient-info-form">
                            <div class="form-group">
                                <label class="form-label" for="patient-name">お名前 *</label>
                                <input type="text" id="patient-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="patient-email">メールアドレス *</label>
                                <input type="email" id="patient-email" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="patient-phone">電話番号 *</label>
                                <input type="tel" id="patient-phone" class="form-control" required>
                            </div>
                            <button type="submit" class="btn btn--primary btn--full-width">次のステップへ</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- ステップ2: 予約種類選択 -->
            <div id="step-2" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h2>予約種類選択</h2>
                    </div>
                    <div class="card__body">
                        <div id="reservation-types" class="reservation-types">
                            <!-- 動的に生成 -->
                        </div>
                        <button id="back-to-step-1" class="btn btn--outline">戻る</button>
                        <button id="next-to-step-3" class="btn btn--primary btn--full-width" disabled>次のステップへ</button>
                    </div>
                </div>
            </div>

            <!-- ステップ3: 日時選択 -->
            <div id="step-3" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h2>日時選択</h2>
                    </div>
                    <div class="card__body">
                        <div class="datetime-selection">
                            <div class="form-group">
                                <label class="form-label" for="reservation-date">希望日</label>
                                <input type="date" id="reservation-date" class="form-control">
                            </div>
                            <div class="time-slots" id="time-slots">
                                <!-- 動的に生成 -->
                            </div>
                        </div>
                        <button id="back-to-step-2" class="btn btn--outline">戻る</button>
                        <button id="next-to-step-4" class="btn btn--primary btn--full-width" disabled>次のステップへ</button>
                    </div>
                </div>
            </div>

            <!-- ステップ4: 確認 -->
            <div id="step-4" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h2>予約内容確認</h2>
                    </div>
                    <div class="card__body">
                        <div id="reservation-summary" class="reservation-summary">
                            <!-- 動的に生成 -->
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="notes">備考</label>
                            <textarea id="notes" class="form-control" rows="3" placeholder="特別な要望や連絡事項があればご記入ください"></textarea>
                        </div>
                        <button id="back-to-step-3" class="btn btn--outline">戻る</button>
                        <button id="confirm-reservation" class="btn btn--primary btn--full-width">予約を確定する</button>
                    </div>
                </div>
            </div>

            <!-- ステップ5: 完了 -->
            <div id="step-5" class="step-content">
                <div class="card">
                    <div class="card__header">
                        <h2>予約完了</h2>
                    </div>
                    <div class="card__body">
                        <div class="completion-message">
                            <div class="success-icon">✓</div>
                            <p>予約が完了しました。</p>
                            <div id="public-message" class="public-message">
                                <!-- 動的に生成 -->
                            </div>
                        </div>
                        <button id="new-reservation" class="btn btn--primary btn--full-width">新しい予約をする</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 管理者ログイン -->
    <div id="admin-login" class="admin-login hidden">
        <div class="container">
            <div class="card" style="max-width: 400px; margin: 50px auto;">
                <div class="card__header">
                    <h2>管理者ログイン</h2>
                </div>
                <div class="card__body">
                    <form id="admin-login-form">
                        <div class="form-group">
                            <label class="form-label" for="admin-password">パスワード</label>
                            <input type="password" id="admin-password" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn--primary btn--full-width">ログイン</button>
                    </form>
                    <div id="login-error" class="error-message hidden"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 管理画面 -->
    <div id="admin-system" class="admin-system hidden">
        <div class="admin-header">
            <div class="container">
                <div class="flex justify-between items-center">
                    <h1>管理画面</h1>
                    <button id="logout-btn" class="btn btn--outline btn--sm">ログアウト</button>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- タブナビゲーション -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="reservations">予約管理</button>
                <button class="tab-btn" data-tab="types">予約種類管理</button>
                <button class="tab-btn" data-tab="settings">設定管理</button>
            </div>

            <!-- 予約管理タブ -->
            <div id="reservations-tab" class="tab-content active">
                <div class="card">
                    <div class="card__header">
                        <h3>予約一覧</h3>
                    </div>
                    <div class="card__body">
                        <div id="reservations-list" class="reservations-list">
                            <!-- 動的に生成 -->
                        </div>
                    </div>
                </div>

                <!-- プリント出力セクション -->
                <div class="card mt-8">
                    <div class="card__header">
                        <h3>プリント出力</h3>
                    </div>
                    <div class="card__body">
                        <div class="print-controls">
                            <div class="form-group">
                                <label class="form-label" for="print-reservation-type">予約種類</label>
                                <select id="print-reservation-type" class="form-control">
                                    <!-- 動的に生成 -->
                                </select>
                            </div>
                            <div class="flex gap-16">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label" for="print-start-date">開始日</label>
                                    <input type="date" id="print-start-date" class="form-control">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label" for="print-end-date">終了日</label>
                                    <input type="date" id="print-end-date" class="form-control">
                                </div>
                            </div>
                            <button id="execute-print" class="btn btn--primary">プリント実行</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 予約種類管理タブ -->
            <div id="types-tab" class="tab-content">
                <div class="card">
                    <div class="card__header">
                        <h3>予約種類管理</h3>
                    </div>
                    <div class="card__body">
                        <div id="reservation-types-list" class="reservation-types-list">
                            <!-- 動的に生成 -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- 設定管理タブ -->
            <div id="settings-tab" class="tab-content">
                <!-- データ管理 -->
                <div class="card">
                    <div class="card__header">
                        <h3>データ管理</h3>
                    </div>
                    <div class="card__body">
                        <div class="data-management">
                            <div class="backup-section">
                                <h4>バックアップ</h4>
                                <p>システムの全データをJSONファイルとしてバックアップできます。</p>
                                <button id="create-backup" class="btn btn--primary">バックアップ作成</button>
                            </div>
                            <div class="restore-section mt-8">
                                <h4>データ復元</h4>
                                <p>バックアップファイルからデータを復元します。</p>
                                <input type="file" id="restore-file" accept=".json" class="form-control">
                                <button id="execute-restore" class="btn btn--warning" disabled>データ復元実行</button>
                            </div>
                            <div class="emergency-section mt-8">
                                <h4>緊急時復旧</h4>
                                <p>データが破損した場合に初期データを復元します。</p>
                                <button id="emergency-restore" class="btn btn--error">初期データ復元</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- メール設定 -->
                <div class="card mt-8">
                    <div class="card__header">
                        <h3>メール設定</h3>
                    </div>
                    <div class="card__body">
                        <div class="emailjs-config">
                            <div class="connection-status" id="emailjs-status">
                                <span class="status-indicator" id="status-indicator"></span>
                                <span id="status-text">未設定</span>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="emailjs-service-id">Service ID</label>
                                <input type="text" id="emailjs-service-id" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="emailjs-template-id">Template ID</label>
                                <input type="text" id="emailjs-template-id" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="emailjs-public-key">Public Key</label>
                                <input type="text" id="emailjs-public-key" class="form-control">
                            </div>
                            <div class="flex gap-8">
                                <button id="test-emailjs-connection" class="btn btn--secondary">接続テスト</button>
                                <button id="send-test-email" class="btn btn--secondary">テストメール送信</button>
                                <button id="save-emailjs-config" class="btn btn--primary">設定保存</button>
                            </div>
                            <div id="emailjs-test-results" class="test-results mt-8 hidden">
                                <!-- テスト結果表示 -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- システム設定 -->
                <div class="card mt-8">
                    <div class="card__header">
                        <h3>システム設定</h3>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="hospital-name">病院名</label>
                            <input type="text" id="hospital-name" class="form-control">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="public-message">公開メッセージ</label>
                            <textarea id="public-message-input" class="form-control" rows="3"></textarea>
                        </div>
                        <button id="save-system-settings" class="btn btn--primary">設定保存</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- プリント表示エリア -->
    <div id="print-area" class="print-area hidden">
        <div id="print-content" class="print-content">
            <!-- プリント内容が動的に生成される -->
        </div>
    </div>

    <!-- フッター -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 さくら病院. All rights reserved.</p>
            <button id="admin-access" class="btn btn--outline btn--sm">管理者ログイン</button>
        </div>
    </footer>

    <!-- 確認ダイアログ -->
    <div id="confirm-dialog" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirm-title">確認</h3>
            </div>
            <div class="modal-body">
                <p id="confirm-message"></p>
            </div>
            <div class="modal-footer">
                <button id="confirm-cancel" class="btn btn--outline">キャンセル</button>
                <button id="confirm-ok" class="btn btn--primary">OK</button>
            </div>
        </div>
        <div class="modal-backdrop"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>
