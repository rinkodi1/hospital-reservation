<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>病院予約システム</title>
    <link rel="stylesheet" href="style.css">
    <!-- Vue.js CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <div id="app">
        <!-- 公開予約画面 -->
        <div v-if="currentView === 'public'" class="container">
            <header class="header">
                <h1>病院予約システム</h1>
                <div class="admin-login-section">
                    <!-- 修正：type="button"を明示的に指定し、.prevent修飾子を追加 -->
                    <button type="button" 
                            class="admin-login-btn" 
                            @click.prevent="showAdminLogin">
                        管理者ログイン
                    </button>
                </div>
            </header>

            <main class="main-content">
                <div class="reservation-form">
                    <h2>予約申込</h2>
                    <form @submit.prevent="submitReservation">
                        <div class="form-group">
                            <label for="name">名前 *</label>
                            <input type="text" id="name" v-model="reservation.name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">メールアドレス *</label>
                            <input type="email" id="email" v-model="reservation.email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">電話番号 *</label>
                            <input type="tel" id="phone" v-model="reservation.phone" required>
                        </div>
                        <div class="form-group">
                            <label for="type">予約種別 *</label>
                            <select id="type" v-model="reservation.type" required>
                                <option value="">選択してください</option>
                                <option value="health-check">健康診断</option>
                                <option value="vaccination">予防接種</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="date">予約希望日 *</label>
                            <input type="date" id="date" v-model="reservation.date" required>
                        </div>
                        <div class="form-group">
                            <label for="time">希望時間 *</label>
                            <select id="time" v-model="reservation.time" required>
                                <option value="">時間を選択</option>
                                <option value="09:00">09:00</option>
                                <option value="10:00">10:00</option>
                                <option value="11:00">11:00</option>
                                <option value="14:00">14:00</option>
                                <option value="15:00">15:00</option>
                                <option value="16:00">16:00</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="notes">備考</label>
                            <textarea id="notes" v-model="reservation.notes" placeholder="病院へのメッセージがあればご記入ください"></textarea>
                        </div>
                        <button type="submit" class="submit-btn">予約申込</button>
                    </form>
                </div>
            </main>
        </div>

        <!-- 管理者ログイン画面 -->
        <div v-if="currentView === 'login'" class="login-container">
            <div class="login-form">
                <h2>管理者ログイン</h2>
                <form @submit.prevent="adminLogin">
                    <div class="form-group">
                        <label for="password">パスワード</label>
                        <input type="password" 
                               id="password" 
                               v-model="adminPassword" 
                               placeholder="管理者パスワードを入力"
                               required>
                    </div>
                    <div class="button-group">
                        <button type="submit" class="login-btn">ログイン</button>
                        <button type="button" 
                                class="cancel-btn" 
                                @click.prevent="backToPublic">
                            キャンセル
                        </button>
                    </div>
                </form>
                <div v-if="loginError" class="error-message">
                    {{ loginError }}
                </div>
            </div>
        </div>

        <!-- 管理画面 -->
        <div v-if="currentView === 'admin'" class="admin-container">
            <header class="admin-header">
                <h1>管理画面</h1>
                <button type="button" 
                        class="logout-btn" 
                        @click.prevent="logout">
                    ログアウト
                </button>
            </header>

            <nav class="admin-nav">
                <button type="button" 
                        class="nav-btn" 
                        :class="{active: adminTab === 'reservations'}"
                        @click.prevent="adminTab = 'reservations'">
                    予約管理
                </button>
                <button type="button" 
                        class="nav-btn" 
                        :class="{active: adminTab === 'types'}"
                        @click.prevent="adminTab = 'types'">
                    予約種別管理
                </button>
                <button type="button" 
                        class="nav-btn" 
                        :class="{active: adminTab === 'settings'}"
                        @click.prevent="adminTab = 'settings'">
                    設定
                </button>
            </nav>

            <main class="admin-main">
                <!-- 予約管理 -->
                <div v-if="adminTab === 'reservations'" class="admin-section">
                    <h2>予約管理</h2>
                    <div class="reservation-list">
                        <div v-for="reservation in reservations" :key="reservation.id" class="reservation-item">
                            <div class="reservation-info">
                                <strong>{{ reservation.name }}</strong> - {{ reservation.type }}
                                <br>{{ reservation.date }} {{ reservation.time }}
                            </div>
                            <div class="reservation-actions">
                                <button type="button" 
                                        class="edit-btn" 
                                        @click.prevent="editReservation(reservation)">
                                    編集
                                </button>
                                <button type="button" 
                                        class="delete-btn" 
                                        @click.prevent="deleteReservation(reservation.id)">
                                    削除
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- その他のタブ内容 -->
                <div v-if="adminTab === 'types'" class="admin-section">
                    <h2>予約種別管理</h2>
                    <p>予約種別の管理機能（実装予定）</p>
                </div>

                <div v-if="adminTab === 'settings'" class="admin-section">
                    <h2>システム設定</h2>
                    <p>各種設定機能（実装予定）</p>
                </div>
            </main>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
